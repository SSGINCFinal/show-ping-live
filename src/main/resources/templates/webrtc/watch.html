<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout.html">
<div layout:fragment="content">
  <link rel="stylesheet" th:href="@{/css/watch/stream.css}">
  <link rel="stylesheet" th:href="@{/webjars/ekko-lightbox/5.2.0/dist/ekko-lightbox.css}">
  <link rel="shortcut icon" th:href="@{/img/kurento.png}" type="image/png" />

  <script th:src="@{/webjars/jquery/3.7.1/dist/jquery.js}"></script>
  <script th:src="@{/webjars/ekko-lightbox/5.2.0/dist/ekko-lightbox.min.js}"></script>
  <script th:src="@{/webjars/webrtc-adapter/7.4.0/release/adapter.js}"></script>
  <script th:src="@{https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js}"></script>
  <script th:src="@{https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js}"></script>

  <script th:inline="javascript">
    let streamInfo = false;
    let chatRoomInfo = [[${chatRoomInfo}]];
    let streamNo = (typeof chatRoomInfo !== "undefined" && chatRoomInfo !== null) ? chatRoomInfo.streamNo : null;
    let chatRoomNo = [[${chatRoomInfo.chatRoomNo}]];
  </script>
  
  <script th:src="@{/js/kurento-utils.js}"></script>
  <script th:src="@{/js/stream/stream.js}"></script>
  <script th:src="@{/js/stream/watch.js}"></script>

  <div class="main-contents">
    <div class="content-container">
      <div class="live-container">
        <div class="video">
          <video id="live" autoplay playsinline>
          </video>
        </div>
      </div>
      <div class="chat-container">
        <!-- 공지 영역 -->
        <div class="announcement">
          공지 | Live 방송 중에만 초특가 <strong>45% 세일 !!</strong>
        </div>

        <div class="chat-messages" id="chat-messages">
          <!-- 초기 메시지 추가 가능 -->
        </div>

        <!-- 최신 채팅으로 이동 버튼 -->
        <button id="scroll-to-latest" class="scroll-button" style="display:none;">
          ↓ 최신 채팅으로 이동
        </button>

        <!-- 메시지 입력 영역 -->
        <div class="input-container">
          <input type="text" id="message-input" placeholder="메시지 입력" maxlength="200">
          <span id="char-count">0/200 </span>
          <button id="send-button">➤</button>
        </div>
      </div>
      
      <div class="product-view-container">
        <!-- 상단 탭 영역 -->
        <div class="tabs">
          <button class="active">상품 정보</button>
          <button>FAQ</button>
          <button>이벤트</button>
        </div>
        <!-- 상품 이미지 영역 -->
        <div class="product-image">
          <!-- 실제 이미지를 사용하실 경우 src 속성을 변경하세요 -->
          <img th:src="@{'/img/product_img/' + ${productInfo.productImg}}" alt="상품 이미지" th:if="${productInfo != null}">
        </div>
        <!-- 상품 정보 영역 (하단) -->
        <div class="product-details" th:if="${productInfo != null}">
          <p class="product-view-name" th:text="${productInfo.productName}"></p>
          <div class="prices">
            <span class="current-view-price" th:text="${productInfo.productSalePrice}"></span>
            <span class="original-view-price" th:text="${productInfo.productPrice}"></span>
          </div>
          <button class="buy-button">구매하기</button>
        </div>
      </div>
    </div>

    <div class="report-modal" id="reportModal">
      <h2>채팅 신고</h2>
      <p class="description">신고 사유를 선택해 주세요.</p>
      <form id="reportForm">
        <div class="radio-group">
          <label class="radio-label">
            <input type="radio" name="reportReason" value="음란성, 폭력성 또는 괴롭힘" required/>
            음란성, 폭력성 또는 괴롭힘
          </label>
          <label class="radio-label">
            <input type="radio" name="reportReason" value="비방 및 명예훼손"/>
            비방 및 명예훼손
          </label>
          <label class="radio-label">
            <input type="radio" name="reportReason" value="스팸 및 도배 행위"/>
            스팸 및 도배 행위
          </label>
          <label class="radio-label">
            <input type="radio" name="reportReason" value="광고성 또는 부적절한 발언"/>
            광고성 또는 부적절한 발언
          </label>
        </div>
        <div class="report-content">
          <!-- 신고 대상 정보가 동적으로 들어갈 부분 -->
          <p class="chatContent" id="reportTargetText">신고 대상의 채팅 내용</p>
        </div>
        <div class="button-group">
          <button type="button" id="cancelBtn">취소</button>
          <button type="submit" id="submitBtn">신고하기</button>
        </div>
      </form>
    </div>

  </div>
  <br>
</div>
</html>