<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout.html">
<div layout:fragment="content">
    <link rel="stylesheet" href="/webjars/bootstrap/5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/webrtc/kurento.css">
    <link rel="stylesheet" href="/webjars/ekko-lightbox/5.2.0/dist/ekko-lightbox.css">
    <link rel="stylesheet" href="/webjars/demo-console/1.5.1/index.css">
    <link rel="stylesheet" href="/css/chat/chat.css">
    <link rel="shortcut icon" href="/img/kurento.png" type="image/png"/>

    <script src="/webjars/jquery/3.7.1/dist/jquery.js"></script>
    <script src="/webjars/bootstrap/5.3.3/dist/js/bootstrap.min.js"></script>
    <script src="/webjars/webrtc-adapter/7.4.0/release/adapter.js"></script>
    <script src="/webjars/demo-console/1.5.1/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>

    <script th:inline="javascript">
        let chatRoomNo = [[${chatRoomNo}]];
        let memberId   = [[${memberId}]];
    </script>

    <script src="/js/chat/chatRoom.js"></script>

    <div class="container">
        <!-- WebRTC Video Section -->
        <div class="live-container">
            <div id="video">
                <video id="live-video" autoplay width="300px" height="480px"
                       poster="/img/webrtc.png"></video>
            </div>
        </div>

        <div class="chat-container">
            <!-- 공지 영역 -->
            <div class="announcement">
                공지 | Live 방송 중에만 초특가 <strong>45% 세일 !!</strong>
            </div>

            <!-- 채팅 메시지 영역 -->
            <div class="chat-wrapper">
                <!-- 메시지는 초기에는 빈 상태이며, 실시간 WebSocket 메시지로 채워짐 -->
                <div class="chat-messages" id="chat-messages">
                    <!-- 초기 메시지가 필요하다면 여기에 추가 가능 -->
                </div>

                <!-- 최신 채팅으로 이동 버튼 -->
                <button id="scroll-to-latest" class="scroll-button">
                    ↓ 최신 채팅으로 이동
                </button>
            </div>

            <!-- 메시지 입력 영역 -->
            <div class="input-container">
                <input type="text" id="message-input" placeholder="메시지 입력">
                <button id="send-button">➤</button>
            </div>
        </div>

        <!-- Product Section -->
        <div class="product-container">
            <div id="product">
                <h1>상품화면</h1>
            </div>
        </div>
    </div>

    <!-- Buttons for WebRTC and Chat -->
    <br>
    <div class="container">
        <div class="settings-buttons">
            <!-- WebRTC Buttons -->
            <div>
                <button id="presenter" class="btn btn-success" onclick="presenter()">
                    송출시작
                </button>
                <button id="viewer" class="btn btn-primary" onclick="viewer()">
                    방송시청
                </button>
                <button id="stop" href="#" class="btn btn-danger" onclick="stop()">
                    송출종료
                </button>
            </div>

            <!-- Chat Buttons -->
            <div>
                <button id="chatStart" class="btn btn-success" onclick="createChatRoom()">
                    채팅시작
                </button>
                <button id="chatStop" href="#" class="btn btn-danger" onclick="stopChat()">
                    채팅종료
                </button>
            </div>
        </div>
    </div>
</div>
</body>
</html>
